dataframes and datasets 
val df =spark,read,json(“/locationinhdfs”)
this will create a dataframe 
df.printschema it will show you the schemas (which is the column and the records in the column)

.read is what makes a dataframe
.text will be an RDD

query with the df methods…
-drop
-count
-join
-select
-sort
-unionAll

THIS IS A QUERY
df.select(“name”).show 
	-this will select all from the column “name”

df.select($“age” +1).show
show the ages and add one 

ALSO CREATE DATAFRAME FROM AN RDD
-val rdd = sc.parallelize(seq(4,blah,2),(56,foo,3),(100,null,3))

val df2 =rdd.toDF
creates a dataframe with default column names (_1,_2,_3)

you can change the column names by 

val df2 =rdd.toDF(“A”,”B”,”C”)
those will be the column names 

df2.withColumn(“C”,”D”).show 
it will change the column name from c to D

val df3 = df2.withColum(“E”,when($”B”.isNull or $”B=== “” , “_empty_”).otherwise($”B”))

val myExpression = “x+y”

val df4 = sc.parallelize(seq(1,2))).toDF(“x”,”y”).show

import org.apache.spark.sql.funtions.expr

df4.withColumn(“sum” , expr(myExpression)).show

import spark.implicits._

val df5 = Seq((“Steak”,1,1,150)), (“steak”,2,2,180),(“fish”,3,3,100).toDF(c1,c2,c3,c4)

df.withColumn(“c5”, expre(c2/c3+c4)”).show

CREATING A UDF (user defined function so we can use it with dataframes)

val replaceUDF =udf((data:String,rep:String)=> data.replaceAll(rep, “”))

df5.withColumn(“edited”,replaceUDF($”senetence” , $label)).show

data.dropDuplicates(“x”).show
drop the duplicates its not apparent which duplicate it will drop 

data.dropDuplicates(Array(“x”,”count”).show

data.select(“*”).where($”Y” > 50).show
select all from data where column y is greater than 50 


AGGREGATE FUNCTION ON DATAFRAME
data.groupBy(“x”).sum(“columncount”)
`-max
 -min
 -avg
 -mean 

JOINS ON A DATAFRAME

emp.join(dept,emp(“emp_dept_id”)===dept(“dept_id),”Inner”).show
join the employee table on emp_dep_id is equal to dept at dept_id it is an inner join.














dataset doesnt have strongly types column names which is why you cant query it as well as a dataframe(alias of an array of dataset rows)



